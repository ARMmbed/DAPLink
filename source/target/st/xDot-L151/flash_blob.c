/* Flash OS Routines (Automagically Generated)
 * Copyright (c) 2009-2015 ARM Limited
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

static const uint32_t stm32l151_flash_prog_blob[] = {
    0xE00ABE00, 0x062D780D, 0x24084068, 0xD3000040, 0x1E644058, 0x1C49D1FA, 0x2A001E52, 0x4770D1F2,
    0xbf182a01, 0xd1122a02, 0x680148ab, 0x6170f441, 0x1d006001, 0xf4106800, 0xd1081f80, 0xf24548a7, 
    0x60015155, 0x60412106, 0x71fff640, 0x20006081, 0x28014770, 0x2802bf18, 0x48a1d108, 0xf0416801, 
    0x60010102, 0xf0416801, 0x60010101, 0x47702000, 0xc26cf8df, 0x1000f8dc, 0x0f01f011, 0x499ad004, 
    0x600a4a98, 0x600a4a99, 0x1000f8dc, 0x0f02f011, 0x4998d004, 0x600a4a96, 0x600a4a97, 0x1000f8dc, 
    0x7100f441, 0x1000f8cc, 0x1000f8dc, 0x0108f041, 0x1000f8cc, 0x60012100, 0x68014887, 0x0f01f011, 
    0xf64abf1c, 0x4a8521aa, 0x6011d004, 0xf0136803, 0xd1fa0f01, 0x0000f8dc, 0x7000f420, 0x0000f8cc, 
    0x0000f8dc, 0x0008f020, 0x0000f8cc, 0x47702000, 0x4df0e92d, 0x4f7b4d7c, 0x81f0f8df, 0xa1f0f8df, 
    0xb1f4f8df, 0x4c754b74, 0xf04f4a75, 0x1d2e6000, 0x0e00f04f, 0x2caaf64a, 0xf0116811, 0xbf1c0f01, 
    0xf8c5602f, 0x68118000, 0x0f02f011, 0xf8c6bf1c, 0xf8c6a000, 0x6811b000, 0x7100f441, 0x68116011, 
    0x0108f041, 0xf8c06011, 0x6819e000, 0x0f01f011, 0xf8c4d005, 0x6819c000, 0x0f01f011, 0x6811d1f9, 
    0x7100f421, 0x68116011, 0x0108f021, 0x49636011, 0x7080f500, 0xd3cf4288, 0xe8bd2000, 0x20018df0, 
    0xb4f04770, 0x31ff4e56, 0x01fff021, 0xf0136833, 0xd0080f01, 0xf8df4b54, 0xf8c3c14c, 0xf8dfc000, 
    0xf8c3c14c, 0x6833c000, 0x0f02f013, 0x4b51d008, 0xc13cf8df, 0xc000f8c3, 0xc13cf8df, 0xc000f8c3, 
    0xf0136833, 0xbf070f01, 0xf0136833, 0x20010f02, 0xbf18bcf0, 0x68334770, 0x6380f443, 0x68336033, 
    0x0308f043, 0xf8df6033, 0xf8dcc0f0, 0x4d3b3000, 0x0f01f013, 0x24aaf64a, 0x602cd005, 0x3000f8dc, 
    0x0f01f013, 0x2380d1f9, 0xf852e005, 0xf8407b10, 0x1f097b04, 0x29001f1b, 0x2b00bf18, 0xf8dcd1f5, 
    0xf0133000, 0xd0050f01, 0xf8dc602c, 0xf0133000, 0xd1f90f01, 0x3000f8dc, 0x6f70f413, 0x6833d136, 
    0x6380f423, 0x68336033, 0x0308f023, 0x68336033, 0x6380f443, 0x68336033, 0x0308f043, 0xf8dc6033, 
    0xf0133000, 0xd0050f01, 0xf8dc602c, 0xf0133000, 0xd1f90f01, 0xe0052380, 0x7b10f852, 0x7b04f840, 
    0x1f1b1f09, 0xbf182900, 0xd1f52b00, 0x0000f8dc, 0x0f01f010, 0x602cd005, 0x0000f8dc, 0x0f01f010, 
    0xf8dcd1f9, 0xf4100000, 0xd0096f70, 0x0000f8dc, 0x1000f8dc, 0x6170f441, 0x1000f8cc, 0x4770bcf0, 
    0xf4206830, 0x60306080, 0xf0206830, 0x60300008, 0x2000bcf0, 0x00004770, 0x40023c18, 0x40003000, 
    0x40023c04, 0x89abcdef, 0x40023c0c, 0x02030405, 0x8c9daebf, 0x40023c10, 0x13141516, 0x08040000, 
    0x00000000, 
};

static const program_target_t flash = {
    0x20000021, // Init
    0x20000053, // UnInit
    0x200000F1, // EraseChip
    0x20000071, // EraseSector
    0x20000183, // ProgramPage

    // BKPT : start of blob + 1
    // RSB  : blob start + header + rw data offset
    // RSP  : stack pointer
    {
        0x20000000 + 0x00000001,
        0x20000000 + 0x00000020 + 0x000002e0,
        0x20000800
    },

    0x20000000 + 0x00000A00,   // mem buffer location
    0x20000000,                // location to write prog_blob in target RAM
    sizeof(stm32l151_flash_prog_blob), // prog_blob size
    stm32l151_flash_prog_blob,         // address of prog_blob
    0x00000200                 // ram_to_flash_bytes_to_be_written
};
